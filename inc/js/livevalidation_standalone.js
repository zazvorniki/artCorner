// LiveValidation 1.3 (standalone version)
// Copyright (c) 2007-2008 Alec Hill (www.livevalidation.com)
// LiveValidation is licensed under the terms of the MIT License

/*********************************************** LiveValidation class ***********************************/

var LiveValidation=function(a,b){this.initialize(a,b)};LiveValidation.VERSION="1.3 standalone",LiveValidation.TEXTAREA=1,LiveValidation.TEXT=2,LiveValidation.PASSWORD=3,LiveValidation.CHECKBOX=4,LiveValidation.SELECT=5,LiveValidation.FILE=6,LiveValidation.massValidate=function(a){var b=!0;for(var c=0,d=a.length;c<d;++c){var e=a[c].validate();b&&(b=e)}return b},LiveValidation.prototype={validClass:"LV_valid",invalidClass:"LV_invalid",messageClass:"LV_validation_message",validFieldClass:"LV_valid_field",invalidFieldClass:"LV_invalid_field",initialize:function(a,b){var c=this;if(!a)throw new Error("LiveValidation::initialize - No element reference or element id has been provided!");this.element=a.nodeName?a:document.getElementById(a);if(!this.element)throw new Error("LiveValidation::initialize - No element with reference or id of '"+a+"' exists!");this.validations=[],this.elementType=this.getElementType(),this.form=this.element.form;var d=b||{};this.validMessage=d.validMessage||"";var e=d.insertAfterWhatNode||this.element;this.insertAfterWhatNode=e.nodeType?e:document.getElementById(e),this.onValid=d.onValid||function(){this.insertMessage(this.createMessageSpan()),this.addFieldClass()},this.onInvalid=d.onInvalid||function(){this.insertMessage(this.createMessageSpan()),this.addFieldClass()},this.onlyOnBlur=d.onlyOnBlur||!1,this.wait=d.wait||0,this.onlyOnSubmit=d.onlyOnSubmit||!1,this.form&&(this.formObj=LiveValidationForm.getInstance(this.form),this.formObj.addField(this)),this.oldOnFocus=this.element.onfocus||function(){},this.oldOnBlur=this.element.onblur||function(){},this.oldOnClick=this.element.onclick||function(){},this.oldOnChange=this.element.onchange||function(){},this.oldOnFoucusOut=this.element.OnFoucusOut||function(){},this.element.onfocus=function(a){return c.doOnFocus(a),c.oldOnFocus.call(this,a)};if(!this.onlyOnSubmit)switch(this.elementType){case LiveValidation.CHECKBOX:this.element.onclick=function(a){return c.validate(),c.oldOnClick.call(this,a)};case LiveValidation.SELECT:case LiveValidation.FILE:this.element.onchange=function(a){return c.validate(),c.oldOnChange.call(this,a)};break;default:this.onlyOnBlur||(this.element.OnFoucusOut=function(a){return c.deferValidation(),c.oldOnFoucusOut.call(this,a)}),this.element.onblur=function(a){return c.doOnBlur(a),c.oldOnBlur.call(this,a)}}},destroy:function(){this.formObj&&(this.formObj.removeField(this),this.formObj.destroy()),this.element.onfocus=this.oldOnFocus;if(!this.onlyOnSubmit)switch(this.elementType){case LiveValidation.CHECKBOX:this.element.onclick=this.oldOnClick;case LiveValidation.SELECT:case LiveValidation.FILE:this.element.onchange=this.oldOnChange;break;default:this.onlyOnBlur||(this.element.OnFoucusOut=this.oldOnFoucusOut),this.element.onblur=this.oldOnBlur}this.validations=[],this.removeMessageAndFieldClass()},add:function(a,b){return this.validations.push({type:a,params:b||{}}),this},remove:function(a,b){var c=!1;for(var d=0,e=this.validations.length;d<e;d++)if(this.validations[d].type==a&&this.validations[d].params==b){c=!0;break}return c&&this.validations.splice(d,1),this},deferValidation:function(a){this.wait>=300&&this.removeMessageAndFieldClass();var b=this;this.timeout&&clearTimeout(b.timeout),this.timeout=setTimeout(function(){b.validate()},b.wait)},doOnBlur:function(a){this.focused=!1,this.validate(a)},doOnFocus:function(a){this.focused=!0,this.removeMessageAndFieldClass()},getElementType:function(){switch(!0){case this.element.nodeName.toUpperCase()=="TEXTAREA":return LiveValidation.TEXTAREA;case this.element.nodeName.toUpperCase()=="INPUT"&&this.element.type.toUpperCase()=="TEXT":return LiveValidation.TEXT;case this.element.nodeName.toUpperCase()=="INPUT"&&this.element.type.toUpperCase()=="PASSWORD":return LiveValidation.PASSWORD;case this.element.nodeName.toUpperCase()=="INPUT"&&this.element.type.toUpperCase()=="CHECKBOX":return LiveValidation.CHECKBOX;case this.element.nodeName.toUpperCase()=="INPUT"&&this.element.type.toUpperCase()=="FILE":return LiveValidation.FILE;case this.element.nodeName.toUpperCase()=="SELECT":return LiveValidation.SELECT;case this.element.nodeName.toUpperCase()=="INPUT":throw new Error("LiveValidation::getElementType - Cannot use LiveValidation on an "+this.element.type+" input!");default:throw new Error("LiveValidation::getElementType - Element must be an input, select, or textarea!")}},doValidations:function(){this.validationFailed=!1;for(var a=0,b=this.validations.length;a<b;++a){var c=this.validations[a];switch(c.type){case Validate.Presence:case Validate.Confirmation:case Validate.Acceptance:this.displayMessageWhenEmpty=!0,this.validationFailed=!this.validateElement(c.type,c.params);break;default:this.validationFailed=!this.validateElement(c.type,c.params)}if(this.validationFailed)return!1}return this.message=this.validMessage,!0},validateElement:function(a,b){var c=this.elementType==LiveValidation.SELECT?this.element.options[this.element.selectedIndex].value:this.element.value;if(a==Validate.Acceptance){if(this.elementType!=LiveValidation.CHECKBOX)throw new Error("LiveValidation::validateElement - Element to validate acceptance must be a checkbox!");c=this.element.checked}var d=!0;try{a(c,b)}catch(e){if(!(e instanceof Validate.Error))throw e;if(c!==""||c===""&&this.displayMessageWhenEmpty)this.validationFailed=!0,this.message=e.message,d=!1}finally{return d}},validate:function(){if(!this.element.disabled){var a=this.doValidations();return a?(this.onValid(),!0):(this.onInvalid(),!1)}return!0},enable:function(){return this.element.disabled=!1,this},disable:function(){return this.element.disabled=!0,this.removeMessageAndFieldClass(),this},createMessageSpan:function(){var a=document.createElement("span"),b=document.createTextNode(this.message);return a.appendChild(b),a},insertMessage:function(a){this.removeMessage();if(this.displayMessageWhenEmpty&&(this.elementType==LiveValidation.CHECKBOX||this.element.value=="")||this.element.value!=""){var b=this.validationFailed?this.invalidClass:this.validClass;a.className+=" "+this.messageClass+" "+b,this.insertAfterWhatNode.nextSibling?this.insertAfterWhatNode.parentNode.insertBefore(a,this.insertAfterWhatNode.nextSibling):this.insertAfterWhatNode.parentNode.appendChild(a)}},addFieldClass:function(){this.removeFieldClass(),this.validationFailed?this.element.className.indexOf(this.invalidFieldClass)==-1&&(this.element.className+=" "+this.invalidFieldClass):(this.displayMessageWhenEmpty||this.element.value!="")&&this.element.className.indexOf(this.validFieldClass)==-1&&(this.element.className+=" "+this.validFieldClass)},removeMessage:function(){var a,b=this.insertAfterWhatNode;while(b.nextSibling){if(b.nextSibling.nodeType===1){a=b.nextSibling;break}b=b.nextSibling}a&&a.className.indexOf(this.messageClass)!=-1&&this.insertAfterWhatNode.parentNode.removeChild(a)},removeFieldClass:function(){this.element.className.indexOf(this.invalidFieldClass)!=-1&&(this.element.className=this.element.className.split(this.invalidFieldClass).join("")),this.element.className.indexOf(this.validFieldClass)!=-1&&(this.element.className=this.element.className.split(this.validFieldClass).join(" "))},removeMessageAndFieldClass:function(){this.removeMessage(),this.removeFieldClass()}};var LiveValidationForm=function(a){this.initialize(a)};LiveValidationForm.instances={},LiveValidationForm.getInstance=function(a){var b=Math.random()*Math.random();return a.id||(a.id="formId_"+b.toString().replace(/\./,"")+(new Date).valueOf()),LiveValidationForm.instances[a.id]||(LiveValidationForm.instances[a.id]=new LiveValidationForm(a)),LiveValidationForm.instances[a.id]},LiveValidationForm.prototype={initialize:function(a){this.name=a.id,this.element=a,this.fields=[],this.oldOnSubmit=this.element.onsubmit||function(){};var b=this;this.element.onsubmit=function(a){return LiveValidation.massValidate(b.fields)?b.oldOnSubmit.call(this,a||window.event)!==!1:!1}},addField:function(a){this.fields.push(a)},removeField:function(a){var b=[];for(var c=0,d=this.fields.length;c<d;c++)this.fields[c]!==a&&b.push(this.fields[c]);this.fields=b},destroy:function(a){return this.fields.length!=0&&!a?!1:(this.element.onsubmit=this.oldOnSubmit,LiveValidationForm.instances[this.name]=null,!0)}};var Validate={Presence:function(a,b){var b=b||{},c=b.failureMessage||"Can't be empty!";return(a===""||a===null||a===undefined)&&Validate.fail(c),!0},Numericality:function(a,b){var c=a,a=Number(a),b=b||{},d=b.minimum||b.minimum==0?b.minimum:null,e=b.maximum||b.maximum==0?b.maximum:null,f=b.is||b.is==0?b.is:null,g=b.notANumberMessage||"Must be a number!",h=b.notAnIntegerMessage||"Must be an integer!",i=b.wrongNumberMessage||"Must be "+f+"!",j=b.tooLowMessage||"Must be more than "+d+"!",k=b.tooHighMessage||"Must be less than "+e+"!";isFinite(a)||Validate.fail(g),b.onlyInteger&&(/\.0+$|\.$/.test(String(c))||a!=parseInt(a))&&Validate.fail(h);switch(!0){case f!==null:a!=Number(f)&&Validate.fail(i);break;case d!==null&&e!==null:Validate.Numericality(a,{tooLowMessage:j,minimum:d}),Validate.Numericality(a,{tooHighMessage:k,maximum:e});break;case d!==null:a<Number(d)&&Validate.fail(j);break;case e!==null:a>Number(e)&&Validate.fail(k)}return!0},Format:function(a,b){var a=String(a),b=b||{},c=b.failureMessage||"Website must include http://",d=b.pattern||/./,e=b.negate||!1;return!e&&!d.test(a)&&Validate.fail(c),e&&d.test(a)&&Validate.fail(c),!0},Email:function(a,b){var b=b||{},c=b.failureMessage||"Must be a valid email address!";return Validate.Format(a,{failureMessage:c,pattern:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}),!0},Length:function(a,b){var a=String(a),b=b||{},c=b.minimum||b.minimum==0?b.minimum:null,d=b.maximum||b.maximum==0?b.maximum:null,e=b.is||b.is==0?b.is:null,f=b.wrongLengthMessage||"Must be "+e+" characters long!",g=b.tooShortMessage||"Must be more than "+c+" characters long!",h=b.tooLongMessage||"Must be less than "+d+" characters long!";switch(!0){case e!==null:a.length!=Number(e)&&Validate.fail(f);break;case c!==null&&d!==null:Validate.Length(a,{tooShortMessage:g,minimum:c}),Validate.Length(a,{tooLongMessage:h,maximum:d});break;case c!==null:a.length<Number(c)&&Validate.fail(g);break;case d!==null:a.length>Number(d)&&Validate.fail(h);break;default:throw new Error("Validate::Length - Length(s) to validate against must be provided!")}return!0},Inclusion:function(a,b){var b=b||{},c=b.failureMessage||"Must be at least five characters long and include special characters and numbers",d=b.caseSensitive===!1?!1:!0;if(b.allowNull&&a==null)return!0;!b.allowNull&&a==null&&Validate.fail(c);var e=b.within||[];if(!d){var f=[];for(var g=0,h=e.length;g<h;++g){var i=e[g];typeof i=="string"&&(i=i.toLowerCase()),f.push(i)}e=f,typeof a=="string"&&(a=a.toLowerCase())}var j=!1;for(var k=0,h=e.length;k<h;++k)e[k]==a&&(j=!0),b.partialMatch&&a.indexOf(e[k])!=-1&&(j=!0);return(!b.negate&&!j||b.negate&&j)&&Validate.fail(c),!0},Exclusion:function(a,b){var b=b||{};return b.failureMessage=b.failureMessage||"Please do not include numbers!",b.negate=!0,Validate.Inclusion(a,b),!0},Confirmation:function(a,b){if(!b.match)throw new Error("Validate::Confirmation - Error validating confirmation: Id of element to match must be provided!");var b=b||{},c=b.failureMessage||"Passwords don't match!",d=b.match.nodeName?b.match:document.getElementById(b.match);if(!d)throw new Error("Validate::Confirmation - There is no reference with name of, or element with id of '"+b.match+"'!");return a!=d.value&&Validate.fail(c),!0},Acceptance:function(a,b){var b=b||{},c=b.failureMessage||"Must be accepted!";return a||Validate.fail(c),!0},Custom:function(a,b){var b=b||{},c=b.against||function(){return!0},d=b.args||{},e=b.failureMessage||"Website must include http://";return c(a,d)||Validate.fail(e),!0},now:function(a,b,c){if(!a)throw new Error("Validate::now - Validation function must be provided!");var d=!0;try{a(b,c||{})}catch(e){if(e instanceof Validate.Error)d=!1;else throw e}finally{return d}},fail:function(a){throw new Validate.Error(a)},Error:function(a){this.message=a,this.name="ValidationError"}}